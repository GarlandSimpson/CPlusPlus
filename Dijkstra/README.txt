NOTE: This implementation is still being optimized and cleaned up

